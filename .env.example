# Server configuration
SERVER_HOST=127.0.0.1
SERVER_PORT=8080

# Upstream backend (required)
PROXY_UPSTREAM_URL=http://localhost:3000

# Proxy settings
PROXY_TIMEOUT_SECS=30
PROXY_PRESERVE_HOST=false

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_SECOND=100
RATE_LIMIT_BURST_CAPACITY=10

# Storage backend: memory | redis
RATE_LIMIT_STORAGE=memory

# Redis URL (required when RATE_LIMIT_STORAGE=redis)
# REDIS_URL=redis://127.0.0.1:6379

# Fingerprinting filter
FINGERPRINT_ENABLED=true
FINGERPRINT_DENY_THRESHOLD=85
FINGERPRINT_CHALLENGE_THRESHOLD=70

# Comma-separated User-Agent patterns (case-insensitive)
FINGERPRINT_USER_AGENT_WHITELIST=googlebot,bingbot
FINGERPRINT_USER_AGENT_BLACKLIST=

# Header analysis settings
FINGERPRINT_STRICT_HEADER_ORDER=false
FINGERPRINT_REQUIRE_COMMON_HEADERS=true

# Slowloris protection
SLOWLORIS_ENABLED=true
SLOWLORIS_HEADER_TIMEOUT_SECS=10
SLOWLORIS_REQUEST_TIMEOUT_SECS=60
SLOWLORIS_MAX_CONNECTIONS_PER_IP=10
SLOWLORIS_CONNECTION_RATE_PER_SEC=5
SLOWLORIS_IDLE_TIMEOUT_SECS=30

# Slowloris storage backend: memory | redis
SLOWLORIS_STORAGE=memory

# Proof-of-Work Challenge Configuration: memory | redis
CHALLENGE_ENABLED=false
CHALLENGE_DIFFICULTY=20  # 16-24 bits (16=easy, 20=medium, 24=hard)
CHALLENGE_TIMEOUT_SECS=300
CHALLENGE_SESSION_DURATION_SECS=3600
CHALLENGE_STORAGE=memory

# Note: REDIS_URL is shared between rate limiting, Slowloris, and challenge storage
# When using Redis for any feature, uncomment and configure:
# REDIS_URL=redis://127.0.0.1:6379